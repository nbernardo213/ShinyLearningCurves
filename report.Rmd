---
title: "Learning Curve Report"
output: html_document
params: 
  n: character
  Tbl: data.frame
  dtlong: data.frame
  SetTbl: data.frame
  indColor: NA
  StudentName: character
author: "`r params$StudentName`"

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
```

## Lego Set Color 

```{r echo=FALSE}
params$n
```

## Timing Data Table

```{r echo=FALSE}
params$Tbl
```


## Learning Curve Plots

```{r echo=FALSE, warning=FALSE, include=FALSE}
   eq1<-function(x){(params$Tbl[1,2])/(1^((log10(params$Tbl[16,2])-log10(params$Tbl[1,2]))/(log10(16)-log10(1))))*x^((log10(params$Tbl[16,2])-log10(params$Tbl[1,2]))/(log10(16)-log10(1)))}
   eq2<-function(x){(params$Tbl[1,3])/(1^((log10(params$Tbl[16,3])-log10(params$Tbl[1,3]))/(log10(16)-log10(1))))*x^((log10(params$Tbl[16,3])-log10(params$Tbl[1,3]))/(log10(16)-log10(1)))}
   eq3<-function(x){(params$Tbl[1,4])/(1^((log10(params$Tbl[16,4])-log10(params$Tbl[1,4]))/(log10(16)-log10(1))))*x^((log10(params$Tbl[16,4])-log10(params$Tbl[1,4]))/(log10(16)-log10(1)))}
```  


###**Individual Graphs**

```{r echo=FALSE,warning=FALSE,message=FALSE}
   ggplot(data =params$Tbl,aes(params$Tbl[,1],params$Tbl[,2]))+
     geom_point(color = as.character(params$n))+
     geom_line()+
     ggtitle(paste(names(params$Tbl)[2]))+
     theme(plot.title = element_text(size=20, hjust = .5))+
     xlab("Trials")+
     ylab("Duration")+
     scale_y_continuous(expand=c(.1,.1),limits = c(min(params$Tbl[,2]),NA))+
     scale_x_continuous(breaks = seq(1,16,1))+
     stat_function(fun = eq1,aes(color = paste("Power Curve: ",as.character(params$SetTbl[1,params$n]))),color = "magenta3")
```


```{r echo=FALSE,warning=FALSE,message=FALSE}
ggplot(data =params$Tbl,aes(params$Tbl[,1],params$Tbl[,3]))+
     geom_point(color = as.character(params$n))+
     geom_line()+
     ggtitle(paste(names(params$Tbl)[3]))+
     theme(plot.title = element_text(size=20, hjust = .5))+
     xlab("Trials")+
     ylab("Duration")+
     scale_y_continuous(expand=c(.1,.1),limits = c(min(params$Tbl[,3]),NA))+
     scale_x_continuous(breaks = seq(1,16,1))+
     stat_function(fun = eq2,aes(color = paste("Power Curve: ",as.character(params$SetTbl[1,params$n]))),color = "magenta3")
```


```{r echo=FALSE,warning=FALSE,message=FALSE}
ggplot(data =params$Tbl,aes(params$Tbl[,1],params$Tbl[,4]))+
     geom_point(color = as.character(params$n))+
     geom_line()+
     ggtitle(paste(names(params$Tbl)[4]))+
     theme(plot.title = element_text(size=20, hjust = .5))+
     xlab("Trials")+
     ylab("Duration")+
     scale_y_continuous(expand=c(.1,.1),limits = c(min(params$Tbl[,4]),NA))+
     scale_x_continuous(breaks = seq(1,16,1))+
     stat_function(fun = eq3,aes(color = paste("Power Curve: ",as.character(params$SetTbl[1,params$n]))),color = "magenta3")
```


###**Combined Graphs**

```{r echo=FALSE,warning=FALSE,message=FALSE}
   ggplot(data = params$dtlong,aes(params$dtlong[,1],Duration,color=Lego))+
     geom_point(aes(shape = Lego),color = as.character(params$n))+
     geom_line()+
     ggtitle(paste(params$n," Set: Data"))+
     theme(plot.title = element_text(size=20, hjust = .5))+
     xlab("Trials")+
     scale_y_continuous(expand=c(.1,.1),limits = c(min(params$dtlong[,3]),NA))+
     scale_x_continuous(breaks = seq(1,16,1))
```


```{r echo=FALSE,warning=FALSE,message=FALSE}
   ggplot(data = params$dtlong,aes(params$dtlong[,1],Duration,color=Lego))+
     ggtitle(paste(params$n," Set: Power Curves"))+
     theme(plot.title = element_text(size=20, hjust = .5))+
     xlab("Trials")+
     scale_x_continuous(breaks = seq(1,16,1))+
     stat_function(fun = eq1,aes(color = paste("Power Curve: ",as.character(params$SetTbl[1,params$n]))))+
     stat_function(fun = eq2,aes(color = paste("Power Curve: ",as.character(params$SetTbl[2,params$n]))))+
     stat_function(fun = eq3,aes(color = paste("Power Curve: ",as.character(params$SetTbl[3,params$n]))))

```


```{r echo=FALSE,warning=FALSE,message=FALSE}
   ggplot(data = params$dtlong,aes(params$dtlong[,1],Duration,color=Lego))+
     geom_point(aes(shape = Lego),color = as.character(params$n))+
     geom_line()+
     ggtitle(paste(params$n," Set: Data and Power Curves"))+
     theme(plot.title = element_text(size=20, hjust = .5))+
     xlab("Trials")+
     scale_y_continuous(expand=c(.1,.1),limits = c(min(params$dtlong[,3]),NA))+
     scale_x_continuous(breaks = seq(1,16,1))+
     stat_function(fun = eq1,aes(color = paste("Power Curve: ",as.character(params$SetTbl[1,params$n]))),color = "#F8766D")+
     stat_function(fun = eq2,aes(color = paste("Power Curve: ",as.character(params$SetTbl[2,params$n]))),color = "limegreen")+
     stat_function(fun = eq3,aes(color = paste("Power Curve: ",as.character(params$SetTbl[3,params$n]))),color = "#00BFC4")
```



## Equations

**`r as.character(params$SetTbl[1,params$n])`**: y = `r (params$Tbl[1,2])/(1^((log10(params$Tbl[16,2])-log10(params$Tbl[1,2]))/(log10(16)-log10(1))))` x ^(`r ((log10(params$Tbl[16,2])-log10(params$Tbl[1,2]))/(log10(16)-log10(1)))`) (Red)

**`r as.character(params$SetTbl[2,params$n])`**: y = `r (params$Tbl[1,3])/(1^((log10(params$Tbl[16,3])-log10(params$Tbl[1,3]))/(log10(16)-log10(1))))` x ^(`r ((log10(params$Tbl[16,3])-log10(params$Tbl[1,3]))/(log10(16)-log10(1)))`) (Green)

**`r as.character(params$SetTbl[3,params$n])`**: y = `r (params$Tbl[1,4])/(1^((log10(params$Tbl[16,4])-log10(params$Tbl[1,4]))/(log10(16)-log10(1))))` x ^(`r ((log10(params$Tbl[16,4])-log10(params$Tbl[1,4]))/(log10(16)-log10(1)))`) (Blue)




